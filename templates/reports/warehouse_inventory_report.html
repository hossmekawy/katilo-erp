{% extends "reports/report_base.html" %}

{% block content %}
<div class="filters-box">
    <div class="filters-title">معايير التقرير:</div>
    <div class="filter-item">المستودع: {{ report.warehouse.name }}</div>
    <div class="filter-item">الفئة: {{ report.category }}</div>
    <div class="filter-item">تضمين العناصر بدون مخزون: {{ "نعم" if report.include_zero_stock else "لا" }}</div>
</div>

<div class="section">
    <h2>معلومات المستودع</h2>
    <div class="summary-box">
        <div class="summary-item">
            <span>اسم المستودع:</span>
            <span>{{ report.warehouse.name }}</span>
        </div>
        <div class="summary-item">
            <span>الموقع:</span>
            <span>{{ report.warehouse.location or 'غير محدد' }}</span>
        </div>
        <div class="summary-item">
            <span>السعة:</span>
            <span>{{ report.warehouse.capacity or 'غير محدد' }}</span>
        </div>
        <div class="summary-item">
            <span>معلومات الاتصال:</span>
            <span>{{ report.warehouse.contact_info or 'غير محدد' }}</span>
        </div>
    </div>
</div>

<div class="section">
    <h2>ملخص المخزون</h2>
    <div class="summary-box">
        <div class="summary-item">
            <span>إجمالي العناصر:</span>
            <span>{{ report.total_items }}</span>
        </div>
        <div class="summary-item">
            <span>إجمالي الكمية:</span>
            <span>{{ report.total_quantity }}</span>
        </div>
        <div class="summary-item">
            <span>إجمالي القيمة:</span>
            <span>{{ "%.2f"|format(report.total_value) }} ج.م</span>
        </div>
        <div class="summary-item">
            <span>عناصر منخفضة المخزون:</span>
            <span>{{ report.low_stock_count }}</span>
        </div>
    </div>
</div>

<div class="section">
    <h2>ملخص الفئات</h2>
    <table>
        <thead>
            <tr>
                <th>الفئة</th>
                <th>عدد العناصر</th>
                <th>إجمالي الكمية</th>
                <th>إجمالي القيمة</th>
            </tr>
        </thead>
        <tbody>
            {% for category in report.category_summary %}
            <tr>
                <td>{{ category.name }}</td>
                <td>{{ category.item_count }}</td>
                <td>{{ category.total_quantity }}</td>
                <td>{{ "%.2f"|format(category.total_value) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="section">
    <h2>تفاصيل المخزون</h2>
    <table>
        <thead>
            <tr>
                <th>العنصر</th>
                <th>الرمز</th>
                <th>الفئة</th>
                <th>الكمية</th>
                <th>حد إعادة الطلب</th>
                <th>وحدة القياس</th>
                <th>التكلفة</th>
                <th>إجمالي التكلفة</th>
                <th>آخر تحديث</th>
                <th>الحالة</th>
            </tr>
        </thead>
        <tbody>
            {% for item in report.inventory_data %}
            <tr>
                <td>{{ item.item_name }}</td>
                <td>{{ item.sku }}</td>
                <td>{{ item.category_name }}</td>
                <td {% if item.status == 'Low Stock' %}class="status-low"{% endif %}>
                    {{ item.quantity }}
                </td>
                <td>{{ item.reorder_level }}</td>
                <td>{{ item.unit_of_measure }}</td>
                <td>{{ "%.2f"|format(item.cost) }}</td>
                <td>{{ "%.2f"|format(item.total_cost) }}</td>
                <td>{{ item.last_updated }}</td>
                <td>
                    {% if item.status == 'Low Stock' %}
                        <span class="status-low">منخفض المخزون</span>
                    {% else %}
                        <span class="status-ok">متوفر</span>
                    {% endif %}
                    {% if item.status == 'Low Stock' %}
                        <span class="status-low">منخفض المخزون</span>
                    {% else %}
                        <span class="status-ok">متوفر</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
